
    <link href="https://ssl.gstatic.com/docs/script/css/add-ons.css" type="text/css" rel="stylesheet" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <style>
    .contacts { 
    width: 400px; 
    margin: 0 auto;  
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    overflow-y: auto;
    padding: 12px;
    }
    .control-label { display: inline-block; min-width: 110px; }
    </style>

<div class="contacts">

  <h2 class="title">Albert's magical address book updating software thingie v4.1</h2>

  <p id="message">
    Please fill-in this form and your contact information will automatically get updated into my address book. Thanks for your time. 
  </p>

  <form id="contactform">
    <p>
      <label class="control-label" for="inputName">Your Name</label>
      <input type="text" id="inputFULL_NAME" placeholder="Full Name" value="<?= name ?>">
    </p>

    <p>
      <label class="control-label" for="inputHomeEmail">Personal Email Address</label>
      <input type="text" id="inputHOME_EMAIL" class="input-large" value="<?= home_email ?>">
    </p>
    
    <p>
      <label class="control-label" for="inputWorkEmail">Work Email Address</label>
      <input type="text" id="inputWORK_EMAIL" class="input-large" value="<?= work_email ?>">
    </p>    

    <p>
      <label class="control-label" for="inputAddressWork">Mailing Address</label>
      <input type="text" id="inputHOME_ADDRESS" class="input-xlarge" value="<?= home_address ?>">
    </p>

    <p>  
      <label class="control-label" for="inputMobilePhone">Mobile Phone</label>
      <input type="text" id="inputMOBILE_PHONE" class="input-medium" value="<?= mobile_phone ?>">
    </p>

<!--
    <p>
      <label class="control-label" for="inputSkype">Skype</label>
      <input type="text" id="inputSKYPE" class="input-small"  placeholder="@username">
    </p>

    <p><label class="control-label" for="inputTwitter">Twitter</label>
      <input type="text" id="inputTWITTER" class="input-small" placeholder="@username">
    </p>
-->
    <p>
      <label class="control-label" for="inputDOB">Birthday</label>
      <input type="text" id="inputBIRTHDAY" class="input-small" placeholder="MM/DD/YYYY">
    </p>

    <p>
      <label class="control-label" for="inputHomePage">Home Page</label>
      <input type="text" id="inputHOME_PAGE" class="input" value="<?= home_page ?>">
    </p>
    <!--
    <p>
      <label class="control-label" for="inputBlog">Blog</label>
      <input type="text" id="inputBLOG" class="input" value="<? // blog ?>">
    </p>
    -->
    <p>
      <input type="hidden" name="id" value="<?= id; ?>" />
      <input type="submit" class="btn blue" value="Update Entry" onclick="updateGoogleContacts(); return false;">
    </p>
  </form>
  <hr />
  <h3>Need help?</h3>
  <p>Just email me at atwong@alumni.uci.edu or give me a call and I'll update your entry manually.</p>

</div>



<script>

  function progress() {
    $("#message").html("Your contact details have been updated in my address book. Thanks!");
    return;
  }

  function updateGoogleContacts() {

    var contact = {};

    contact.FULL_NAME    = $("input#inputFULL_NAME").val();
    contact.HOME_EMAIL   = $("input#inputHOME_EMAIL").val();
    contact.WORK_EMAIL   = $("input#inputWORK_EMAIL").val();    
    contact.HOME_ADDRESS = $("input#inputHOME_ADDRESS").val();
    contact.MOBILE_PHONE = $("input#inputMOBILE_PHONE").val();
//    contact.SKYPE        = $("input#inputSKYPE").val();
//    contact.TWITTER      = $("input#inputTWITTER").val();
//    contact.BLOG         = $("input#inputBLOG").val();
    contact.HOME_PAGE    = $("input#inputHOME_PAGE").val();    
    contact.BIRTHDAY     = $("input#inputBIRTHDAY").val();
    contact.id           = "<?= id ?>";

    google.script.run.withSuccessHandler(progress).labnolUpdateContact(contact);      

    $("#contactform").hide();
    $("#message").html("Updating my address book... please wait...");

    return false;

  }

</script>
